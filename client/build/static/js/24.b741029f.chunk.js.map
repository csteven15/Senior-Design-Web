{"version":3,"sources":["pages/UserSearch.js"],"names":["UserSearch","state","nid","first","last","email","level","results","data","getLevelNum","type","getLevelType","searchOnChange","name","event","test","target","value","_this","setState","Object","_Users_stevenchen_Fall2018_Group41_Web_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__","trim","updateTable","urlParams","usernameFilter","firstNameFilter","lastNameFilter","emailAddressFilter","maxResults","props","fetchHelp","then","res","axios","get","concat","URLSearchParams","toString","headers","catch","err","console","log","response","renderTable","map","user","userData","allowedPermits","username","firstName","lastName","emailAddress","accountLevel","permit","push","permitType","permits","join","react__WEBPACK_IMPORTED_MODULE_6___default","a","createElement","_material_ui_core__WEBPACK_IMPORTED_MODULE_8__","header","key","style","fontWeight","InputProps","startAdornment","position","_material_ui_icons__WEBPACK_IMPORTED_MODULE_9__","onChange","margin","required","fullWidth","select","row","onClick","history","pathname","cursor","_components_generic_Spinner__WEBPACK_IMPORTED_MODULE_12__","this","_this2","Fragment","variant","gutterBottom","component","color","mdDown","lgUp","React","Component","withRouter","connect","dispatch","url","method","body","fetchHelper"],"mappings":"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","file":"static/js/24.b741029f.chunk.js","sourcesContent":["import React from 'react';\nimport { connect } from 'react-redux';\nimport {\n  Typography,\n  Button,\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableRow,\n  Paper,\n  TextField,\n  Hidden,\n  InputAdornment,\n  FormControl,\n  MenuItem,\n} from '@material-ui/core';\nimport { FilterList } from '@material-ui/icons';\nimport { withRouter } from 'react-router-dom';\nimport { fetchHelper } from '../actions/AuthActions';\nimport Spinner from '../components/generic/Spinner';\nimport axios from 'axios';\n\nclass UserSearch extends React.Component {\n  state = {\n    nid: '',\n    first: '',\n    last: '',\n    email: '',\n    level: '',\n    results: '100',\n    data: null,\n  };\n\n  componentDidMount() {\n    this.updateTable();\n  }\n\n  getLevelNum = type => {\n    if (type === '') return '';\n    if (type === 'Standard') return '100';\n    if (type === 'Enforcer') return '200';\n    if (type === 'Administrator') return '300';\n    return '';\n  };\n\n  getLevelType = level => {\n    if (level === '') return 'All';\n    if (level === '100') return 'Standard';\n    if (level === '200') return 'Enforcer';\n    if (level === '300') return 'Administrator';\n    return 'All';\n  };\n\n  searchOnChange = name => event => {\n    if (/\\s/g.test(event.target.value)) return;\n    this.setState({ [name]: event.target.value.trim() }, () => this.updateTable());\n  };\n\n  updateTable = () => {\n    let urlParams = {\n      usernameFilter: this.state.nid,\n      firstNameFilter: this.state.first,\n      lastNameFilter: this.state.last,\n      emailAddressFilter: this.state.email,\n      maxResults: this.state.results,\n    };\n    urlParams['accountLevelFilter'] = this.getLevelNum(this.state.level);\n    this.props\n      .fetchHelp()\n      .then(res => {\n        axios\n          .get(`/api/users/searchUsers?${new URLSearchParams(urlParams).toString()}`, {\n            headers: res.headers,\n          })\n          .then(res => this.setState({ data: res.data.results }))\n          .catch(err => console.log(err.response));\n      })\n      .catch(err => console.log(err));\n  };\n\n  renderTable = () => {\n    const data = [];\n    if (this.state.data) {\n      this.state.data.map(user => {\n        const userData = {};\n        const allowedPermits = [];\n        userData.username = user.username;\n        userData.firstName = user.firstName;\n        userData.lastName = user.lastName;\n        userData.emailAddress = user.emailAddress;\n        if (user.accountLevel === 100) userData.accountLevel = 'Standard';\n        if (user.accountLevel === 200) userData.accountLevel = 'Enforcer';\n        if (user.accountLevel === 300) userData.accountLevel = 'Administrator';\n        user.allowedPermits.map(permit => allowedPermits.push(permit.permitType));\n        userData.permits = allowedPermits.join(', ');\n        data.push(userData);\n        return null;\n      });\n    }\n    const levels = ['All', 'Standard', 'Enforcer', 'Administrator'];\n    const tablehead = ['NID', 'First Name', 'Last Name', 'Email', 'Allowed Permits', 'User Level'];\n    return (\n      <Paper>\n        <Table>\n          <TableHead>\n            <TableRow>\n              {tablehead.map((header, key) => (\n                <TableCell key={key} style={{ fontWeight: 700 }}>\n                  {header}\n                </TableCell>\n              ))}\n            </TableRow>\n            <TableRow>\n              <TableCell>\n                <TextField\n                  InputProps={{\n                    startAdornment: (\n                      <InputAdornment position='start'>\n                        <FilterList />\n                      </InputAdornment>\n                    ),\n                  }}\n                  onChange={this.searchOnChange('nid')}\n                  value={this.state.nid}\n                />\n              </TableCell>\n              <TableCell>\n                <TextField\n                  InputProps={{\n                    startAdornment: (\n                      <InputAdornment position='start'>\n                        <FilterList />\n                      </InputAdornment>\n                    ),\n                  }}\n                  onChange={this.searchOnChange('first')}\n                  value={this.state.first}\n                />\n              </TableCell>\n              <TableCell>\n                <TextField\n                  InputProps={{\n                    startAdornment: (\n                      <InputAdornment position='start'>\n                        <FilterList />\n                      </InputAdornment>\n                    ),\n                  }}\n                  onChange={this.searchOnChange('last')}\n                  value={this.state.last}\n                />\n              </TableCell>\n              <TableCell>\n                <TextField\n                  InputProps={{\n                    startAdornment: (\n                      <InputAdornment position='start'>\n                        <FilterList />\n                      </InputAdornment>\n                    ),\n                  }}\n                  onChange={this.searchOnChange('email')}\n                  value={this.state.email}\n                />\n              </TableCell>\n              <TableCell>&nbsp;</TableCell>\n              <TableCell>\n                <FormControl margin='normal' required fullWidth>\n                  <TextField\n                    select\n                    value={this.state.level}\n                    onChange={this.searchOnChange('level')}\n                    InputProps={{\n                      startAdornment: (\n                        <InputAdornment position='start'>\n                          <FilterList />\n                        </InputAdornment>\n                      ),\n                    }}\n                  >\n                    {levels.map((level, key) => (\n                      <MenuItem key={key} value={level}>\n                        {level}\n                      </MenuItem>\n                    ))}\n                  </TextField>\n                </FormControl>\n              </TableCell>\n            </TableRow>\n          </TableHead>\n          <TableBody>\n            {data !== null ? (\n              data.map((row, key) => (\n                <TableRow\n                  onClick={() => {\n                    this.props.history.push({\n                      pathname: '/users/update',\n                      state: { username: row.username },\n                    });\n                  }}\n                  key={key}\n                  style={{ cursor: 'pointer' }}\n                >\n                  <TableCell>{row.username}</TableCell>\n                  <TableCell>{row.firstName}</TableCell>\n                  <TableCell>{row.lastName}</TableCell>\n                  <TableCell>{row.emailAddress}</TableCell>\n                  <TableCell>{row.permits}</TableCell>\n                  <TableCell>{row.accountLevel}</TableCell>\n                </TableRow>\n              ))\n            ) : (\n              <Spinner />\n            )}\n          </TableBody>\n        </Table>\n      </Paper>\n    );\n    // }\n  };\n\n  render() {\n    return (\n      <React.Fragment>\n        <Typography variant='h4' gutterBottom component='h4'>\n          User Look Up\n        </Typography>\n        <Button onClick={() => this.props.history.push('/users/create')} color='secondary' variant='contained'>\n          Create User\n        </Button>\n        <br />\n        <br />\n        <Hidden mdDown>{this.renderTable()}</Hidden>\n        <Hidden lgUp>Please switch to a larger screen to use this tool.</Hidden>\n      </React.Fragment>\n    );\n  }\n}\n\nconst mapDispatchToProps = dispatch => ({\n  fetchHelp: (url, method, header, body) => dispatch(fetchHelper(url, method, header, body)),\n});\n\nexport default withRouter(\n  connect(\n    null,\n    mapDispatchToProps\n  )(UserSearch)\n);\n"],"sourceRoot":""}